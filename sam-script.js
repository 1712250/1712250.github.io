const script=document.createElement("script");script.src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.core.min.js",document.head.appendChild(script),$(".modal-upload-members input[type='submit'].btn").on("click",e=>{e.preventDefault();const t=$(".modal-upload-members input[type='file']")[0].files[0],o=window.location.pathname.split("/").filter(e=>e.length>0)[1],n=[],s=new FileReader;s.onload=function(e){const t=e.target.result,s=XLSX.read(t,{type:"binary"}),a=s.Sheets[s.SheetNames[0]];for(let e in a){const t=a[e];if("n"==t.t){const e=$.ajax({url:`/api/activities/${o}/members/`,type:"POST",data:{member_code:t.v,attended:!0}});n.push(e)}}Promise.all(n).then(()=>console.log("Done!")).catch(e=>console.log("You should use a better browser instead!")),window.workbook=s},s.readAsBinaryString(t)});
